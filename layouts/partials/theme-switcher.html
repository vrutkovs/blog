<li class="navigation-item">
    <div class="theme-toggle-wrapper">
        <label class="theme-toggle" for="theme-switch">
            <input type="checkbox" id="theme-switch" aria-label="Toggle theme" />
            <span class="toggle-track">
                <span class="toggle-thumb">
                    <i class="fa-solid fa-sun sun-icon" aria-hidden="true"></i>
                    <i class="fa-solid fa-moon moon-icon" aria-hidden="true"></i>
                </span>
            </span>
        </label>
    </div>
</li>

<script>
    (function () {
        const themeSwitch = document.getElementById("theme-switch");
        const body = document.body;
        const html = document.documentElement;

        // Check for saved theme preference or default to system preference
        function getPreferredTheme() {
            const savedTheme = localStorage.getItem("theme-preference");
            if (savedTheme) {
                return savedTheme;
            }
            return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
        }

        // Apply theme to the page
        function applyTheme(theme) {
            // Remove both classes first
            body.classList.remove("colorscheme-light", "colorscheme-dark");
            html.classList.remove("colorscheme-light", "colorscheme-dark");

            // Add the appropriate class
            body.classList.add("colorscheme-" + theme);
            html.classList.add("colorscheme-" + theme);

            // Update toggle state
            themeSwitch.checked = theme === "dark";

            // Save preference
            localStorage.setItem("theme-preference", theme);
        }

        // Toggle theme
        function toggleTheme() {
            const currentTheme = body.classList.contains("colorscheme-dark") ? "dark" : "light";
            const newTheme = currentTheme === "dark" ? "light" : "dark";
            applyTheme(newTheme);
        }

        // Event listener
        themeSwitch.addEventListener("change", toggleTheme);

        // Initialize theme on page load
        const currentTheme = getPreferredTheme();
        applyTheme(currentTheme);

        // Listen for system theme changes
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", function (e) {
            if (!localStorage.getItem("theme-preference")) {
                applyTheme(e.matches ? "dark" : "light");
            }
        });
    })();
</script>
